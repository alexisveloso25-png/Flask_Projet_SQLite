<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Livres</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f0f2f5; text-align: center; }
        header { background-color: #2E8B57; color: white; padding: 30px 0; margin-bottom: 20px; }
        header h1 { margin:0; }
        nav a { text-decoration:none; color:#2E8B57; margin:0 10px; font-weight:bold; padding:8px 15px; border:2px solid #2E8B57; border-radius:5px; transition:0.3s; }
        nav a:hover { background:#2E8B57; color:white; }
        .search-form { margin-bottom: 20px; }
        .search-form input { padding: 8px; width: 250px; border-radius:5px; border:1px solid #ccc; }
        .search-form button { padding:8px 15px; border-radius:5px; border:2px solid #2E8B57; background:#2E8B57; color:white; font-weight:bold; cursor:pointer; transition:0.3s; }
        .search-form button:hover { background:#1f5f3b; border-color:#1f5f3b; }
        table { margin:0 auto; border-collapse:collapse; width:90%; max-width:900px; background:white; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
        th, td { padding:12px 15px; border:1px solid #ddd; }
        th { background:#2E8B57; color:white; }
        td button { padding:6px 12px; border-radius:5px; border:2px solid #2E8B57; background:#2E8B57; color:white; font-weight:bold; cursor:pointer; margin:2px; transition:0.3s; }
        td button:hover { background:#1f5f3b; border-color:#1f5f3b; }
        .unavailable { color:red; font-weight:bold; }
        .add-book { display:inline-block; padding:10px 20px; margin:20px auto; border:2px solid #2E8B57; background:#2E8B57; color:white; border-radius:5px; text-decoration:none; font-weight:bold; transition:0.3s; }
        .add-book:hover { background:#1f5f3b; border-color:#1f5f3b; }
    </style>
</head>
<body>
<header><h1>Livres disponibles</h1></header>

<nav>
    <a href="{{ url_for('hello_world') }}">Accueil</a>
    <a href="{{ url_for('mes_emprunts') }}">Mes emprunts</a>
</nav>

<form class="search-form" method="POST" action="{{ url_for('recherche_livres') }}">
    <input type="text" name="titre" placeholder="Rechercher un livre..." required>
    <button type="submit">Rechercher</button>
</form>

<table>
    <tr>
        <th>ID</th><th>Titre</th><th>Auteur</th><th>Stock</th><th>Actions</th>
    </tr>
    {% for livre in livres %}
    <tr>
        <td>{{ livre[0] }}</td>
        <td>{{ livre[1] }}</td>
        <td>{{ livre[2] }}</td>
        <td>{{ livre[3] }}</td>
        <td>
            {% if livre[3] > 0 %}
            <form action="{{ url_for('emprunter_livre', livre_id=livre[0]) }}" method="POST" style="display:inline;">
                <button type="submit">Emprunter</button>
            </form>
            {% else %}<span class="unavailable">Indisponible</span>{% endif %}

            {% if session['role'] == 'admin' %}
            <form action="{{ url_for('supprimer_livre', livre_id=livre[0]) }}" method="POST" style="display:inline;">
                <button type="submit" onclick="return confirm('Supprimer ce livre ?');">Supprimer</button>
            </form>
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>

{% if session['role'] == 'admin' %}
<a class="add-book" href="{{ url_for('ajouter_livre') }}">Ajouter un livre</a>
{% endif %}
</body>
</html>
